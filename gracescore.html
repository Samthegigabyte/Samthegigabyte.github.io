<html><head><script>
        __Admission_Age = {
            "29": "1.5399", "30": "1.593", "31": "1.6461", "32": "1.6992", "33": "1.7523",
            "34": "1.8054", "35": "1.8585", "36": "1.9116", "37": "1.9647", "38": "2.0178", "39": "2.0709",
            "40": "2.124", "41": "2.1771", "42": "2.2302", "43": "2.2833", "44": "2.3364", "45": "2.3895",
            "46": "2.4426", "47": "2.4957", "48": "2.5488", "49": "2.6019", "50": "2.655", "51": "2.7081",
            "52": "2.7612", "53": "2.8143", "54": "2.8674", "55": "2.9205", "56": "2.9736", "57": "3.0267",
            "58": "3.0798", "59": "3.1329", "60": "3.186", "61": "3.2391", "62": "3.2922", "63": "3.3453",
            "64": "3.3984", "65": "3.4515", "66": "3.5046", "67": "3.5577", "68": "3.6108", "69": "3.6639",
            "70": "3.717", "71": "3.7701", "72": "3.8232", "73": "3.8763", "74": "3.9294", "75": "3.9825",
            "76": "4.0356", "77": "4.0887", "78": "4.1418", "79": "4.1949", "80": "4.248", "81": "4.3011",
            "82": "4.3542", "83": "4.4073", "84": "4.4604", "85": "4.5135", "86": "4.5666", "87": "4.6197",
            "88": "4.6728", "89": "4.7259", "90": "4.779", "91": "4.8321", "92": "4.8852", "93": "4.9383",
            "94": "4.9914", "95": "5.0445", "96": "5.0976", "97": "5.1507", "98": "5.2038", "99": "5.2569", "100": "5.31"
        }
        
        __Admission_Pulse = {
            "49":"0.4263", "59.5":"0.51765", "74.5":"0.64815", "84.5":"0.73515", "94.5":"0.82215", "104.5":"0.90915",
            "119.5":"1.03965", "139.5":"1.21365", "174.5":"1.51815", "200":"1.74"
        }
        
        __Admission_BloodPressure = {
            "79":"-1.3272", "89.5":"-1.5036", "104.5":"-1.7556", "114.5":"-1.9236", "124.5":"-2.0916", "134.5":"-2.2596",
            "149.5":"-2.5116", "169.5":"-2.8476", "180":"-3.024"
        }
        
        __Admission_Creatine =  {
            "0.195":"0.0355485", "0.595":"0.1084685", "0.995":"0.1813885", "1.395":"0.2543085", "1.795":"0.3272285",
            "2.995":"0.5459885", "4.0":"0.7292"
        }
        
        __Admission_Renal =  { "no": "0.09115", "yes": "0.3646"}
        __Admission_Killip = { "1": "0.6931", "2": "1.3862", "3": "2.0793", "4": "2.7724"}
        __Admission_Diuretic = { "no": "0.6931", "yes": "1.73275"}
        __Admission_Cardiac = { "no": "0", "yes": "1.4586"}
        __Admission_ElevatedEnzymes = { "no": "0", "yes": "0.4700"}
        __Admission_STEMI ={ "no": "0", "yes": "0.8755"}

        
        
        __SixMonth_Age = { "29": "0", "30": "0", "31": "0", "32": "0", "33": "0", "34": "0", "35": "0", "36": "1.8",
            "37": "3.6", "38": "5.4", "39": "7.2", "40": "9", "41": "10.8", "42": "12.6", "43": "14.4", "44": "16.2",
            "45": "18", "46": "19.8", "47": "21.6", "48": "23.4", "49": "25.2", "50": "27", "51": "28.8", "52": "30.6",
            "53": "32.4", "54": "34.2", "55": "36", "56": "37.8", "57": "39.6", "58": "41.4", "59": "43.2", "60": "45",
            "61": "46.8", "62": "48.6", "63": "50.4", "64": "52.2", "65": "54", "66": "55.9", "67": "57.8", "68": "59.7",
            "69": "61.6", "70": "63.5", "71": "65.4", "72": "67.3", "73": "69.2", "74": "71.1", "75": "73", "76": "74.8",
            "77": "76.6", "78": "78.4", "79": "80.2", "80": "82", "81": "83.8", "82": "85.6", "83": "87.4", "84": "89.2",
            "85": "91", "86": "92.8", "87": "94.6", "88": "96.4", "89": "98.2", "90": "100", "91": "100", "92": "100",
            "93": "100", "94": "100", "95": "100", "96": "100", "97": "100", "98": "100", "99": "100", "100": "100"
        }
        __SixMonth_Pulse = { "49":"0", "59.5":"0", "74.5":"1.35", "84.5":"3.9", "94.5":"6.35", "104.5":"8.9",
            "119.5":"12.85", "139.5":"18.85", "174.5": "29.35", "200":"34.0"
        }
        __SixMonth_BloodPressure = { "79":"40", "89.5":"37.15", "104.5":"32.65", "114.5":"29.2", "124.5":"25.65",
            "134.5":"22.65", "149.5":"16.2", "169.5":"11.15", "180":"8.0"
        }
        __SixMonth_Creatine = { "0.195": "0.975", "0.595": "3.975", "0.995": "6.975", "1.395": "9.95", "1.795": "12.95",
            "2.995": "20.965", "4.0":   "28"
        }
        __SixMonth_Renal ={ "no": "3.5", "yes": "14"
        }
        __SixMonth_Killip = { "1": "0", "2": "15", "3": "29", "4": "44"
        }
        __SixMonth_Diuretic = { "no": "0", "yes": "20"
        }
        __SixMonth_Cardiac = { "no": "0", "yes": "1"
        }
        __SixMonth_ElevatedEnzymes =  { "no": "0", "yes": "1"
        }
        __SixMonth_STEMI ={ "no": "0", "yes": "1"
        }

        
        __OneYear_Age = { "29":"1.193553", "30":"1.23471", "31":"1.275867", "32":"1.317024", "33":"1.358181",
            "34":"1.399338", "35":"1.440495", "36":"1.481652", "37":"1.522809", "38":"1.563966", "39":"1.605123",
            "40":"1.64628", "41":"1.687437", "42":"1.728594", "43":"1.769751", "44":"1.810908", "45":"1.852065",
            "46":"1.893222", "47":"1.934379", "48":"1.975536", "49":"2.0167005", "50":"2.0579297", "51":"2.0993009",
            "52":"2.1408916", "53":"2.1827791", "54":"2.2250408", "55":"2.2677541", "56":"2.3109965", "57":"2.3548453",
            "58":"2.3993779", "59":"2.4446718", "60":"2.4908043", "61":"2.5378528", "62":"2.5858947", "63":"2.6350075",
            "64":"2.6852685", "65":"2.7367551", "66":"2.7895448", "67":"2.8437127", "68":"2.8992632", "69":"2.9561152",
            "70":"3.0141823", "71":"3.0733784", "72":"3.1336173", "73":"3.1948128", "74":"3.2568786", "75":"3.3197285",
            "76":"3.3832763", "77":"3.4474359", "78":"3.5121209", "79":"3.5772452", "80":"3.6427226", "81":"3.7084667",
            "82":"3.7743915", "83":"3.8404108", "84":"3.9064488", "85":"3.9724869", "86":"4.0385249", "87":"4.104563",
            "88":"4.1706011", "89":"4.2366391", "90":"4.3026772", "91":"4.3687153", "92":"4.4347533", "93":"4.5007914",
            "94":"4.5668295", "95":"4.6328675", "96":"4.6989056", "97":"4.7649437", "98":"4.8309817", "99":"4.8970198",
            "100":"4.9630578"
        }
        __OneYear_Pulse = { "49":"0.2145873", "59.5":"0.2687747", "74.5":"0.5049219", "84.5":"0.7361786",
            "94.5":"0.8628367", "104.5":"0.8966225", "119.5":"0.8578086", "139.5":"0.7824602", "174.5":"0.6506006",
            "200":"0.5545314"
        }
        __OneYear_BloodPressure = { "79":"0.4071228", "89.5":"0.2421043", "104.5":"0.0063635", "114.5":"-0.1499551",
            "124.5":"-0.2985642", "134.5":"-0.4299701", "149.5":"-0.5769774", "169.5":"-0.6951633", "180":"-0.7399799"
        }
        __OneYear_Creatine ={ "0.195":"-0.0999551", "0.595":"-0.3049911", "0.995":"-0.2920628", "1.395":"0.2625441",
            "1.795":"0.4717919", "2.995":"0.6085038", "4.0":"0.7131714"
        }
        __OneYear_Killip ={ "1": "0", "2": "0.63827", "3": "0.85325", "4": "1.29372"
        }
        __OneYear_Cardiac ={ "no": "0", "yes": "0.87185"
        }
        __OneYear_ElevatedEnzymes ={ "no": "0", "yes": "0.37660"
        }
        __OneYear_STEMI ={ "no": "0", "yes": "0.44303"
        }
        
        
    function __lookupAge(age,dictAge)
    {
            if(age<29)
                age=29;
            roundstr=Math.round(age).toString();
        return parseFloat(dictAge[roundstr]);
    }

    function __lookupPulse(pulse, dictPulse){
        if(pulse<50)
            npulse=dictPulse["49"];
        else if(50<pulse<70)
            npulse=dictPulse["59.5"];
        else if(70<=pulse<80)
            npulse=dictPulse["74.5"];
        else if(80<=pulse<90)
            npulse=dictPulse["84.5"];
        else if(90<=pulse<100)
            npulse=dictPulse["94.5"];
        else if(100<=pulse<110)
            npulse=dictPulse["104.5"];
        else if(110<=pulse<130)
            npulse=dictPulse["119.5"];
        else if(130<=pulse<149)
            npulse=dictPulse["139.5"];
        else if(150<=pulse<199)
            npulse=dictPulse["174.5"];
        else if(200<=pulse)
            npulse=dictPulse["200"];
            
        return parseFloat(npulse);
        }

    function __lookupBloodPressure(bp, dictBloodPressure){
        if(bp<80)
            nbp=dictBloodPressure["79"];
        else if(80<=bp<100)
            nbp=dictBloodPressure["89.5"];
        else if(100<=bp<110)
            nbp=dictBloodPressure["104.5"];
        else if(110<=bp<120)
            nbp=dictBloodPressure["114.5"];
        else if(120<=bp<130)
            nbp=dictBloodPressure["124.5"];
        else if(130<=bp<140)
            nbp=dictBloodPressure["134.5"];
        else if(140<=bp<160)
            nbp=dictBloodPressure["149.5"];
        else if(160<=bp<180)
            nbp=dictBloodPressure["169.5"];
        else if(180<=bp)
            nbp=dictBloodPressure["180"];
        return parseFloat(nbp)
        }

    function __lookupCrea(cr, dictCrea){
        if(cr<0.039)
            ncr=dictCrea["0.195"];
        else if(0.4<=cr<0.8)
            ncr=dictCrea["0.595"];
        else if(0.8<=cr<1.2)
            ncr=dictCrea["0.995"];
        else if(1.2<=cr<1.6)
            ncr=dictCrea["1.395"];
        else if(1.6<=cr<2.0)
            ncr=dictCrea["1.795"];
        else if(2.0<=cr<4.0)
            ncr=dictCrea["2.995"];
        else if(4.0<=cr)
            ncr=dictCrea["4.0"];
        return parseFloat(ncr);
        }

    function __lookupTF(TF, dictTF){
        if(TF===true)
            return parseFloat(dictTF["yes"]);
        else if(TF===false)
            return parseFloat(dictTF["no"]);
        }

    function __lookupKillip(killip, dictKillip){
        return parseFloat(dictKillip[killip.toString()]);}

    function CalculateOneYearDeath(age, pulse, bloodPressure, creatinine, killip, cardiac, enzymes, stemi){
        
        ageValue = __lookupAge(age,__OneYear_Age);
        pulseValue = __lookupPulse(pulse, __OneYear_Pulse);
        bloodPressureValue = __lookupBloodPressure(bloodPressure,__OneYear_BloodPressure);
        killipValue = __lookupKillip(killip, __OneYear_Killip);
        creatinineValue = __lookupCrea(creatinine, __OneYear_Creatine);
        cardiacValue = __lookupTF(cardiac, __OneYear_Cardiac);
        enzymesValue = __lookupTF(enzymes, __OneYear_ElevatedEnzymes);
        stemiValue = __lookupTF(stemi, __OneYear_STEMI);

        
        xbhat = ageValue + pulseValue + bloodPressureValue + creatinineValue + cardiacValue + enzymesValue + stemiValue + killipValue;
        
        sZeroT = 0.9983577131;
        temp = Math.exp(xbhat);
        temp2 = Math.pow(sZeroT, temp);
        result = 1 - temp2;
        
        return result;
        }


    function CalculateAdmissionToInHospitalDeath(age, pulse, bloodPressure, creatinine,  killip,  cardiac, enzymes, stemi){

        ageValue = __lookupAge(age,__Admission_Age);
        pulseValue = __lookupPulse(pulse, __Admission_Pulse);
        bloodPressureValue = __lookupBloodPressure(bloodPressure,__Admission_BloodPressure);
        killipValue = __lookupKillip(killip, __Admission_Killip);
        creatinineValue = __lookupCrea(creatinine, __Admission_Creatine);
        cardiacValue = __lookupTF(cardiac, __Admission_Cardiac);
        enzymesValue = __lookupTF(enzymes, __Admission_ElevatedEnzymes);
        stemiValue = __lookupTF(stemi, __Admission_STEMI);

        fiddleFactor = -7.7035;

        xbhat = fiddleFactor + ageValue + pulseValue+ bloodPressureValue + creatinineValue + cardiacValue + enzymesValue + stemiValue + killipValue;
        temp = Math.exp(xbhat);

        probabilityOfDeath = temp / (1 + temp);

        return probabilityOfDeath;
        }
    

    function CalculateSixMonthDeath(age, pulse, bloodPressure, creatinine,  killip,  cardiac, enzymes, stemi){

        ageValue = __lookupAge(age,__SixMonth_Age);
        pulseValue = __lookupPulse(pulse, __SixMonth_Pulse);
        bloodPressureValue = __lookupBloodPressure(bloodPressure,__SixMonth_BloodPressure);
        killipValue = __lookupKillip(killip, __SixMonth_Killip);
        creatinineValue = __lookupCrea(creatinine, __SixMonth_Creatine);
        cardiacValue = __lookupTF(cardiac, __SixMonth_Cardiac);
        enzymesValue = __lookupTF(enzymes, __SixMonth_ElevatedEnzymes);
        stemiValue = __lookupTF(stemi, __SixMonth_STEMI);
        probability = 0.0;

        deathmi_pt = killipValue + bloodPressureValue + pulseValue + ageValue + creatinineValue + (17 * stemiValue) + (13 * enzymesValue) + (30 * cardiacValue);
        
        if (deathmi_pt <= 6)
            probability = 0.002;
			
        else if (deathmi_pt > 7 && deathmi_pt <= 27)
            probability = 0.004;
        
        else if (deathmi_pt > 27 && deathmi_pt <= 39)
            probability = 0.006;
        
        else if (deathmi_pt > 39 && deathmi_pt <= 48)
            probability = 0.008;
        
        else if (deathmi_pt > 48 && deathmi_pt <= 55)
            probability = 0.01;
        
        else if (deathmi_pt > 55 && deathmi_pt <= 60)
            probability = 0.012;
        
        else if (deathmi_pt > 60 && deathmi_pt <= 65)
            probability = 0.014;
        
        else if (deathmi_pt > 65 && deathmi_pt <= 69)
            probability = 0.016;
        
        else if (deathmi_pt > 69 && deathmi_pt <= 73)
            probability = 0.018;
        
        else if (deathmi_pt > 73 && deathmi_pt <= 76)
            probability = 0.02;
        
        else if (deathmi_pt > 76 && deathmi_pt <= 88)
            probability = 0.03;
        
        else if (deathmi_pt > 88 && deathmi_pt <= 97)
            probability = 0.04;
        
        else if (deathmi_pt > 97 && deathmi_pt <= 104)
            probability = 0.05;
        
        else if (deathmi_pt > 104 && deathmi_pt <= 110)
            probability = 0.06;
        
        else if (deathmi_pt > 110 && deathmi_pt <= 115)
            probability = 0.07;
        
        else if (deathmi_pt > 115 && deathmi_pt <= 119)
            probability = 0.08;
        
        else if (deathmi_pt > 119 && deathmi_pt <= 123)
            probability = 0.09;
        
        else if (deathmi_pt > 123 && deathmi_pt <= 126)
            probability = 0.10;
        
        else if (deathmi_pt > 126 && deathmi_pt <= 129)
            probability = 0.11;
        
        else if (deathmi_pt > 129 && deathmi_pt <= 132)
            probability = 0.12;
        
        else if (deathmi_pt > 132 && deathmi_pt <= 134)
            probability = 0.13;
        
        else if (deathmi_pt > 134 && deathmi_pt <= 137)
            probability = 0.14;
        
        else if (deathmi_pt > 137 && deathmi_pt <= 139)
            probability = 0.15;
        
        else if (deathmi_pt > 139 && deathmi_pt <= 141)
            probability = 0.16;
        
        else if (deathmi_pt > 141 && deathmi_pt <= 143)
            probability = 0.17;
        
        else if (deathmi_pt > 143 && deathmi_pt <= 146)
            probability = 0.18;
        
        else if (deathmi_pt > 146 && deathmi_pt <= 147)
            probability = 0.19;
        
        else if (deathmi_pt > 147 && deathmi_pt <= 149)
            probability = 0.20;
        
        else if (deathmi_pt > 149 && deathmi_pt <= 150)
            probability = 0.21;
        
        else if (deathmi_pt > 150 && deathmi_pt <= 152)
            probability = 0.22;
        
        else if (deathmi_pt > 152 && deathmi_pt <= 153)
            probability = 0.23;
        
        else if (deathmi_pt > 153 && deathmi_pt <= 155)
            probability = 0.24;
        
        else if (deathmi_pt > 155 && deathmi_pt <= 156)
            probability = 0.25;
        
        else if (deathmi_pt > 156 && deathmi_pt <= 158)
            probability = 0.26;
        
        else if (deathmi_pt > 158 && deathmi_pt <= 159)
            probability = 0.27;
        
        else if (deathmi_pt > 159 && deathmi_pt <= 160)
            probability = 0.28;
        
        else if (deathmi_pt > 160 && deathmi_pt <= 162)
            probability = 0.29;
        
        else if (deathmi_pt > 162 && deathmi_pt <= 163)
            probability = 0.3;
        
        else if (deathmi_pt > 163 && deathmi_pt <= 174)
            probability = 0.4;
        
        else if (deathmi_pt > 174 && deathmi_pt <= 183)
            probability = 0.5;
        
        else if (deathmi_pt > 183 && deathmi_pt <= 191)
            probability = 0.6;
        
        else if (deathmi_pt > 191 && deathmi_pt <= 200)
            probability = 0.7;
        
        else if (deathmi_pt > 200 && deathmi_pt <= 208)
            probability = 0.8;
        
        else if (deathmi_pt > 208 && deathmi_pt <= 219)
            probability = 0.9;
        
        else if (deathmi_pt > 219 && deathmi_pt <= 240)
            probability = 0.99;
        
        else if (deathmi_pt > 240)
            probability = 1.13;
        
        probability = probability * (80 / 91);

        if (probability > 0.90)
            probability = 0.92;
      
        return probability;
      
    }
	
	
    /*grace = "at admission ";
	grace += (CalculateAdmissionToInHospitalDeath(60, 70, 130, 2.0,  3,  false, false, false)*100).toFixed(1)+"%";
    grace += ", after 6 Months ";
    grace += (CalculateSixMonthDeath(60, 70, 130, 2.0,  3,  false, false, false)*100).toFixed(1)+"%";
    grace += ", after one year ";
    grace += (CalculateOneYearDeath(60, 70, 130, 2.0,  3,  false, false, false)*100).toFixed(1)+"%";
    alert(grace);*/
    step = 0;
    agev = -1;
    pulsv = -1;
    sbpv = -1;
    creav = -1.0;
    killipv = -1;
    cardiacv = "false";
    enzymev = "false";
    stemiv = "false";


    function getValues(e)
    {
        if(e.keyCode !== 13)
            return;

        switch(step)
        {
            case 0:
                agev = parseInt(document.getElementById("val").value);
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Puls Eingeben: ";
                step++;
                break;
            case 1:
                pulsv = parseInt(document.getElementById("val").value);
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Systolischer BD: ";
                step++;
                break;
            case 2:
                sbpv = parseInt(document.getElementById("val").value);
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Kreatinin: ";
                step++;
                break;
            case 3:
                creav = parseFloat(document.getElementById("val").value);
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Killip: ";
                step++;
                break;
            case 4:
                killipv = parseInt(document.getElementById("val").value);
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Positiv Kardiakarrest (y/n): ";
                step++;
                break;
            case 5:
                cardiacv = document.getElementById("val").value === "y" ? true : false;
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Positive Herzenzyme (y/n): ";
                step++;
                break;
            case 6:
                enzymev = document.getElementById("val").value === "y" ? true : false;
                document.getElementById("val").value = "";
                document.getElementById("ques").innerHTML = "Positive ST-Störungen (y/n): ";
                step++;
                break;
            case 7:
                stemiv = document.getElementById("val").value === "y" ? true : false;
                document.getElementById("val").value = "";
                grace = "</br><b>Alter: </b>"+agev.toString() +"</br>";
                grace += "<b>Puls: </b>"+ pulsv.toString()+"</br>";
                grace += "<b>Systolicher Blutdruck: </b>"+sbpv.toString()+"</br>";
                grace += "<b>Kreatinin: </b>"+ creav.toString()+"</br>";
                grace += "<b>Killip: </b>"+  killipv.toString()+"</br>";
                grace += "<b>Herzstillstand: </b>"+  cardiacv.toString()+"</br>";
                grace += "<b>Trop: </b>"+ enzymev.toString()+"</br>";
                grace += "<b>St-Abweichungen: </b>"+ stemiv.toString()+"</br>";
                grace += "<br />Grace Score: Death/MI im Krankenhaus ";
                grace += "<b>" + (CalculateAdmissionToInHospitalDeath(agev, pulsv, sbpv, creav,  killipv,  cardiacv, enzymev, stemiv)*100).toFixed(1)+"%</b>";
                grace += ", Death/MI nach 6 Monaten ";
                grace += "<b>"+(CalculateSixMonthDeath(agev, pulsv, sbpv, creav,  killipv,  cardiacv, enzymev, stemiv)*100).toFixed(1)+"%</b>";
                grace += ", Death/MI nach ein Jahe ";
                grace += "<b>"+(CalculateOneYearDeath(agev, pulsv, sbpv, creav,  killipv,  cardiacv, enzymev, stemiv)*100).toFixed(1)+"%</b>";
                document.getElementById("result").innerHTML = grace;
                step = 0;
                break;
        }

    }
    </script></head>
    <body>
        <span id="ques">Alter Eingeben: </span>
        <span><input type="text" id="val" onkeypress="getValues(event)" autofocus /></span>
        <span id="result"></span>
    </body></html>        
